Q10_names <- Q10_names %>% mutate('Avg_Q6'=0)
i=1
while(i <= length(Q10s)){
current <- Q10s[i]
edc3 <- edc2 %>% select(Q6, current[1])
TFvec <- (edc3[2] != 0)
edc3 <- edc3[TFvec,]
avg = mean(edc3$Q6)
Q10_names[i,2] <- avg
i = i+1
}
colnames(Q10_names) <- c("Business_Category","Average_Outlook")
avg_outlook <- round(Q10_names$Average_Outlook,1)
avgs <- ggplot(Q10_names, aes(x=Business_Category, y=Average_Outlook)) +
geom_bar(color='black',fill='royalblue1',stat='identity') +
coord_cartesian(ylim =c(5, 7), expand = FALSE) +
labs(x = " ",y = "Average Reported Outlook" ) +
geom_hline(aes(yintercept=overallavg), color = "red") +
geom_text(aes(label=avg_outlook), position=position_dodge(width=0.9), vjust=-0.25) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1))
avgs
Q10s <- c('Q10_a', 'Q10_b', 'Q10_c', 'Q10_d', 'Q10_e', 'Q10_f', 'Q10_g', 'Q10_h', 'Q10_i', 'Q10_j', 'Q10_k')
namess <- c("Accounting/Finance", "Call Center", "Distribution", "Engineering/R&D", "Headquarters", "Management",
"Manufacuring", "Services", "Warehousing", "IT/Technology", "Other")
edc2 <- edc %>% filter(Q1 < 100) %>%  select(Q6, starts_with("Q10")) %>%  filter(Q6 != 0)
overallavg <- mean(edc2$Q6)
Q10_names <- as.data.frame(namess)
Q10_names <- Q10_names %>% mutate('Avg_Q6'=0)
i=1
while(i <= length(Q10s)){
current <- Q10s[i]
edc3 <- edc2 %>% select(Q6, current[1])
TFvec <- (edc3[2] != 0)
edc3 <- edc3[TFvec,]
avg = mean(edc3$Q6)
Q10_names[i,2] <- avg
i = i+1
}
colnames(Q10_names) <- c("Business_Category","Average_Outlook")
avg_outlook <- round(Q10_names$Average_Outlook,1)
avgs <- ggplot(Q10_names, aes(x=Business_Category, y=Average_Outlook)) +
geom_bar(color='black',fill='royalblue1',stat='identity') +
coord_cartesian(ylim =c(5, 7), expand = FALSE) +
labs(x = " ",y = "Average Reported Outlook" ) +
geom_hline(aes(yintercept=overallavg), color = "red") +
geom_text(aes(label=avg_outlook), position=position_dodge(width=0.9), vjust=-0.25) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1))
avgs
Q10s <- c('Q10_a', 'Q10_b', 'Q10_c', 'Q10_d', 'Q10_e', 'Q10_f', 'Q10_g', 'Q10_h', 'Q10_i', 'Q10_j', 'Q10_k')
namess <- c("Accounting/Finance", "Call Center", "Distribution", "Engineering/R&D", "Headquarters", "Management",
"Manufacuring", "Services", "Warehousing", "IT/Technology", "Other")
edc2 <- edc %>% filter(Q1 < 100) %>%  select(Q6, starts_with("Q10")) %>%  filter(Q6 != 0)
overallavg <- mean(edc2$Q6)
Q10_names <- as.data.frame(namess)
Q10_names <- Q10_names %>% mutate('Avg_Q6'=0)
i=1
while(i <= length(Q10s)){
current <- Q10s[i]
edc3 <- edc2 %>% select(Q6, current[1])
TFvec <- (edc3[2] != 0)
edc3 <- edc3[TFvec,]
avg = mean(edc3$Q6)
Q10_names[i,2] <- avg
i = i+1
}
colnames(Q10_names) <- c("Business_Category","Average_Outlook")
avg_outlook <- round(Q10_names$Average_Outlook,1)
avgs <- ggplot(Q10_names, aes(x=Business_Category, y=Average_Outlook)) +
geom_bar(color='black',fill='darkolivegreen4',stat='identity') +
coord_cartesian(ylim =c(5, 7), expand = FALSE) +
labs(x = " ",y = "Average Reported Outlook" ) +
geom_hline(aes(yintercept=overallavg), color = "red") +
geom_text(aes(label=avg_outlook), position=position_dodge(width=0.9), vjust=-0.25) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1))
avgs
ggplot(edc %>% filter(Q6 != 0), aes(as.factor(Q6), y = 100*(..count../sum(..count..)))) +
geom_bar(color = "black", fill = "goldenrod3") +
labs(x = " ", y = "Percent %", title = "How Do You Rate The Economic Outlook For The Coming Year?", subtitle = "Based on the 2019 Sarasota EDC Survey") +
coord_cartesian(ylim =c(0, 45), expand = FALSE) +
geom_vline(aes(xintercept=5.3), color = "red") +
theme_bw()
Q10s <- c('Q10_a', 'Q10_b', 'Q10_c', 'Q10_d', 'Q10_e', 'Q10_f', 'Q10_g', 'Q10_h', 'Q10_i', 'Q10_j', 'Q10_k')
namess <- c("Accounting/Finance", "Call Center", "Distribution", "Engineering/R&D", "Headquarters", "Management",
"Manufacuring", "Services", "Warehousing", "IT/Technology", "Other")
edc2 <- edc %>% filter(Q1 < 100) %>%  select(Q6, starts_with("Q10")) %>%  filter(Q6 != 0)
overallavg <- mean(edc2$Q6)
Q10_names <- as.data.frame(namess)
Q10_names <- Q10_names %>% mutate('Avg_Q6'=0)
i=1
while(i <= length(Q10s)){
current <- Q10s[i]
edc3 <- edc2 %>% select(Q6, current[1])
TFvec <- (edc3[2] != 0)
edc3 <- edc3[TFvec,]
avg = mean(edc3$Q6)
Q10_names[i,2] <- avg
i = i+1
}
colnames(Q10_names) <- c("Business_Category","Average_Outlook")
avg_outlook <- round(Q10_names$Average_Outlook,1)
avgs <- ggplot(Q10_names, aes(x=Business_Category, y=Average_Outlook)) +
geom_bar(color='black',fill='darkolivegreen4',stat='identity') +
coord_cartesian(ylim =c(5, 7), expand = FALSE) +
labs(x = " ",y = "Average Reported Outlook" ) +
geom_hline(aes(yintercept=overallavg), color = "red") +
geom_text(aes(label=avg_outlook), position=position_dodge(width=0.9), vjust=-0.25) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1))
avgs
edc$Q4 <- gsub(0, NA, edc$Q4)
q4_p <- ggplot(edc, aes(x = Q4, y = 100*(..count../sum(..count..)))) +
geom_bar(color = "black", fill = "mediumorchid3") +
labs(x = " ",y = "Percent %", title = "Is Most Of Your Revenue Generated Outside Sarasota?", subtitle = "Based on the 2019 Sarasota EDC Survey") +
coord_cartesian(ylim =c(0, 80), expand = FALSE) +
theme_bw()
q4_p
ggplot(edc %>% filter(Q6 != 0), aes(as.factor(Q6), y = 100*(..count../sum(..count..)))) +
geom_bar(color = "black", fill = "goldenrod3") +
labs(x = " ", y = "Percent %", title = "How Do You Rate The Economic Outlook For The Coming Year?", subtitle = "Based on the 2019 Sarasota EDC Survey") +
coord_cartesian(ylim =c(0, 45), expand = FALSE) +
geom_vline(aes(xintercept=5.3), color = "red") +
theme_bw()
val <- edc %>% filter(Q6 != 0)
View(val)
mean(val$Q6)
ggplot(edc %>% filter(Q6 != 0), aes(as.factor(Q6), y = 100*(..count../sum(..count..)))) +
geom_bar(color = "black", fill = "goldenrod3") +
labs(x = " ", y = "Percent %", title = "How Do You Rate The Economic Outlook For The Coming Year?", subtitle = "Based on the 2019 Sarasota EDC Survey") +
coord_cartesian(ylim =c(0, 45), expand = FALSE) +
geom_vline(aes(xintercept=6.3), color = "red") +
theme_bw()
Q10s <- c('Q10_a', 'Q10_b', 'Q10_c', 'Q10_d', 'Q10_e', 'Q10_f', 'Q10_g', 'Q10_h', 'Q10_i', 'Q10_j', 'Q10_k')
namess <- c("Accounting/Finance", "Call Center", "Distribution", "Engineering/R&D", "Headquarters", "Management",
"Manufacuring", "Services", "Warehousing", "IT/Technology", "Other")
edc2 <- edc %>% filter(Q1 < 100) %>%  select(Q6, starts_with("Q10")) %>%  filter(Q6 != 0)
overallavg <- mean(edc2$Q6)
Q10_names <- as.data.frame(namess)
Q10_names <- Q10_names %>% mutate('Avg_Q6'=0)
i=1
while(i <= length(Q10s)){
current <- Q10s[i]
edc3 <- edc2 %>% select(Q6, current[1])
TFvec <- (edc3[2] != 0)
edc3 <- edc3[TFvec,]
avg = mean(edc3$Q6)
Q10_names[i,2] <- avg
i = i+1
}
colnames(Q10_names) <- c("Business_Category","Average_Outlook")
avg_outlook <- round(Q10_names$Average_Outlook,1)
avgs <- ggplot(Q10_names, aes(x=Business_Category, y=Average_Outlook)) +
geom_bar(color='black',fill='darkolivegreen4',stat='identity') +
coord_cartesian(ylim =c(5, 7), expand = FALSE) +
labs(x = " ",y = "Average Reported Outlook" ) +
geom_hline(aes(yintercept=overallavg), color = "red") +
geom_text(aes(label=avg_outlook), position=position_dodge(width=0.9), vjust=-0.25) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1))
avgs
#summary(edc$Q2)
q2_p <- ggplot(edc %>% filter(is.na(Q2) == F), aes(x = Q2, y = 100*(..count../sum(..count..)))) +
geom_bar(color = "black", fill = "goldenrod3") +
labs(x = " ",y = "Percent %" ) +
coord_cartesian(ylim =c(0, 100), expand = FALSE) +
theme_bw()
edc$Q2b <- gsub("1 or 2", 2, edc$Q2b)
edc$Q2b <- gsub("unknown", NA, edc$Q2b)
edc$Q2b <- gsub(0, NA, edc$Q2b)
edc$Q2b <- as.numeric(edc$Q2b)
#summary(edc$Q2b)
#str(edc)
q2b_p <- ggplot(edc, aes(Q2b)) +
geom_bar(color = "black", fill = "darkgoldenrod1") +
scale_y_continuous(limits = c(0,120), expand = c(0,0)) +
geom_vline(aes(xintercept=2.5), color = "red") +
labs(x = " ", y="Count") +
theme_bw()
library(gridExtra)
grid.arrange(q2_p, q2b_p, ncol = 2)
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(growth) == F & is.na(Q2) == F) %>%
group_by(growth, Q2) %>%
summarise(n=n()) %>%
group_by(Q2) %>%
mutate(perc=100*n/sum(n))
q5_p7 <- ggplot(Q5_7t, aes(x = growth, y = perc)) +
geom_bar(color = "black", fill = "lightblue", stat = "identity") +
coord_cartesian(ylim =c(0, 90), expand = FALSE) +
labs(x = "Actual Growth Result",y = "Percent %" ) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1)) +
facet_wrap(~Q2, scales = "free") +
scale_fill_brewer(palette="Set2")  +
labs(title = "Plans to Hire vs. Actual Employment Growth", subtitle = "Plan to hire in 2019?")
q5_p7
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(growth) == F & is.na(Q2) == F) %>%
group_by(growth, Q2) %>%
summarise(n=n()) %>%
group_by(Q2) %>%
mutate(perc=100*n/sum(n))
q5_p7 <- ggplot(Q5_7t, aes(x = growth, y = perc)) +
geom_bar(color = "black", fill = "lightblue", stat = "identity") +
coord_cartesian(ylim =c(0, 90), expand = FALSE) +
labs(x = "Actual Growth Result",y = "Percent %" ) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1)) +
facet_wrap(~Q2, scales = "free") +
scale_fill_brewer(palette="Set2")  +
labs(title = "Plans to Hire vs. Actual Employment Growth", subtitle = "Plan to hire in 2019?")
q5_p7
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(growth) == F & is.na(Q2) == F) %>%
group_by(growth, Q2) %>%
summarise(n=n()) %>%
group_by(Q2) %>%
mutate(perc=100*n/sum(n))
q5_p7 <- ggplot(Q5_7t, aes(x = growth, y = perc)) +
geom_bar(color = "black", fill = "lightblue", stat = "identity") +
coord_cartesian(ylim =c(0, 90), expand = FALSE) +
labs(x = "Actual Growth Result",y = "Percent %" ) +
theme_bw() +
scale_fill_brewer(palette="Set2")  +
theme(axis.text.x=element_text(angle=30, hjust=1)) +
facet_wrap(~Q2, scales = "free") +
labs(title = "Plans to Hire vs. Actual Employment Growth", subtitle = "Plan to hire in 2019?")
q5_p7
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(growth) == F & is.na(Q2) == F) %>%
group_by(growth, Q2) %>%
summarise(n=n()) %>%
group_by(Q2) %>%
mutate(perc=100*n/sum(n))
q5_p7 <- ggplot(Q5_7t, aes(x = growth, y = perc)) +
geom_bar(color = "black", stat = "identity") +
scale_fill_brewer(palette="Set2")  +
coord_cartesian(ylim =c(0, 90), expand = FALSE) +
labs(x = "Actual Growth Result",y = "Percent %" ) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1)) +
facet_wrap(~Q2, scales = "free") +
labs(title = "Plans to Hire vs. Actual Employment Growth", subtitle = "Plan to hire in 2019?")
q5_p7
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(growth) == F & is.na(Q2) == F) %>%
group_by(growth, Q2) %>%
summarise(n=n()) %>%
group_by(Q2) %>%
mutate(perc=100*n/sum(n))
q5_p7 <- ggplot(Q5_7t, aes(x = growth, y = perc)) +
geom_bar(color = "black", fill = "wheat3", stat = "identity") +
coord_cartesian(ylim =c(0, 90), expand = FALSE) +
labs(x = "Actual Growth Result",y = "Percent %" ) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1)) +
facet_wrap(~Q2, scales = "free") +
labs(title = "Plans to Hire vs. Actual Employment Growth", subtitle = "Plan to hire in 2019?")
q5_p7
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(growth) == F & is.na(Q5_7) == F & growth != "Hired" & Q2 == "Yes") %>%
group_by(Q5_7) %>%
summarise(n=n()) %>%
#group_by(growth) %>%
mutate(perc=100*n/sum(n))
#print(Q5_7t)
q5_p7 <- ggplot(Q5_7t, aes(x = Q5_7, y = perc)) +
geom_bar(color = "black", fill = "darkorange", stat = "identity") +
coord_cartesian(ylim =c(0, 65), expand = FALSE) +
labs(x = " ",y = "Percent %" ) +
theme_bw() +
labs(title = "Those Who Said They Planned To Hire In 2019 But Did Not", x = "Access To Workforce / Employees")
q5_p7
#res <- prop.test(x = c(51, 77), n = c(392, 405))
#res
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(growth) == F & is.na(Q5_7) == F & growth != "Hired" & Q2 == "Yes") %>%
group_by(Q5_7) %>%
summarise(n=n()) %>%
#group_by(growth) %>%
mutate(perc=100*n/sum(n))
#print(Q5_7t)
q5_p7 <- ggplot(Q5_7t, aes(x = Q5_7, y = perc)) +
geom_bar(color = "black", fill = "darkorange3", stat = "identity") +
coord_cartesian(ylim =c(0, 65), expand = FALSE) +
labs(x = " ",y = "Percent %" ) +
theme_bw() +
labs(title = "Those Who Said They Planned To Hire In 2019 But Did Not", x = "Access To Workforce / Employees")
q5_p7
#res <- prop.test(x = c(51, 77), n = c(392, 405))
#res
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(growth) == F & is.na(Q5_7) == F & growth != "Hired" & Q2 == "Yes") %>%
group_by(Q5_7) %>%
summarise(n=n()) %>%
#group_by(growth) %>%
mutate(perc=100*n/sum(n))
#print(Q5_7t)
q5_p7 <- ggplot(Q5_7t, aes(x = Q5_7, y = perc)) +
geom_bar(color = "black", fill = "darkorange4", stat = "identity") +
coord_cartesian(ylim =c(0, 65), expand = FALSE) +
labs(x = " ",y = "Percent %" ) +
theme_bw() +
labs(title = "Those Who Said They Planned To Hire In 2019 But Did Not", x = "Access To Workforce / Employees")
q5_p7
#res <- prop.test(x = c(51, 77), n = c(392, 405))
#res
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(growth) == F & is.na(Q5_7) == F & growth != "Hired" & Q2 == "Yes") %>%
group_by(Q5_7) %>%
summarise(n=n()) %>%
#group_by(growth) %>%
mutate(perc=100*n/sum(n))
#print(Q5_7t)
q5_p7 <- ggplot(Q5_7t, aes(x = Q5_7, y = perc)) +
geom_bar(color = "black", fill = "darkorange2", stat = "identity") +
coord_cartesian(ylim =c(0, 65), expand = FALSE) +
labs(x = " ",y = "Percent %" ) +
theme_bw() +
labs(title = "Those Who Said They Planned To Hire In 2019 But Did Not", x = "Access To Workforce / Employees")
q5_p7
#res <- prop.test(x = c(51, 77), n = c(392, 405))
#res
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(Q2) == F & is.na(Q5_7) == F) %>%
group_by(Q2, Q5_7) %>%
summarise(n=n()) %>%
group_by(Q2) %>%
mutate(perc=100*n/sum(n))
q5_p7 <- ggplot(Q5_7t, aes(x = Q5_7, y = perc)) +
geom_bar(color = "black", fill = "aquamarine3", stat = "identity") +
coord_cartesian(ylim =c(0, 75), expand = FALSE) +
labs(x = "Access To Workforce",y = "Percent %" ) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1)) +
facet_wrap(~Q2, scales = "free")
q5_p7
Answer <- c("Very Dissatisfied", "Neutral", "Very Satisfied")
topics <- c("Cost of Doing Business", "Cost of Doing Business", "Cost of Doing Business",
"Access to Customers", "Access to Customers", "Access to Customers",
"Proximity to Amenities", "Proximity to Amenities", "Proximity to Amenities",
"Transportation", "Transportation", "Transportation",
"Safety Service", "Safety Service", "Safety Service",
"Housing Affordability", "Housing Affordability", "Housing Affordability",
"Access to Workforce/Employees", "Access to Workforce/Employees", "Access to Workforce/Employees",
"City/County Permitting Process", "City/County Permitting Process", "City/County Permitting Process")
percs <- c()
edc2 <- edc %>% filter(Q10_h == 0)
Q5s <- edc2[,c(11:18)]
for (i in 1:8){
q <- Q5s[,i]
q <- data.frame(q[!is.na(q)])
colnames(q) <- "question"
VD <- round((length(q$question[q$question == "Very Dissatisfied"]) / nrow(q)) * 100, 2)
N <- round((length(q$question[q$question == "Neutral"]) / nrow(q)) * 100, 2)
VS <- round((length(q$question[q$question == "Very Satisfied"]) / nrow(q)) * 100, 2)
percs <- append(percs, c(VD, N, VS))
}
call <- data.frame(topics, Answer, percs)
call$Answer <- fct_relevel(call$Answer, c('Very Dissatisfied', 'Neutral', 'Very Satisfied'))
q <- ggplot(call, aes(x = topics, y=percs, fill = Answer)) +
geom_bar(stat='identity', position = "dodge", color = "black") +
labs(x = "Topic", y = "Percent %", title = "Satisfaction With Community Topics", subtitle = "Based on the 2019 Sarasota EDC Survey") +
scale_y_continuous(expand = c(0,0), limits = c(0,70)) +
theme_bw() +
#theme(axis.text.x=element_text(angle=30, hjust=1)) +
scale_fill_brewer(palette="Set1") +
coord_flip()
q
growth.counts <- edc %>% filter(is.na(growth) == F & Q10_h == 0) %>% group_by(growth) %>% count()
growth <- ggplot(edc  %>% filter(is.na(growth) == F & Q10_h == 0), aes(x = growth, y = 100*(..count../sum(..count..)), fill = growth)) +
geom_bar(color = "black") +
coord_cartesian(ylim =c(0, 45), expand = FALSE) +
labs(x = " ",y = "Percent %" ) +
theme_bw() +
scale_fill_brewer(palette="Set2")  +
theme(legend.position = "None")
growth
edc$Q5_7 <- fct_relevel(edc$Q5_7, c("Very Dissatisfied", "Neutral", "Very Satisfied"))
Q5_7t <- edc %>%
filter(is.na(growth) == F & is.na(Q5_7) == F & Q10_h == 0) %>%
group_by(growth, Q5_7) %>%
summarise(n=n()) %>%
group_by(growth) %>%
mutate(perc=100*n/sum(n))
q5_p7 <- ggplot(Q5_7t, aes(x = Q5_7, y = perc)) +
geom_bar(color = "black", fill = "steelblue4", stat = "identity") +
coord_cartesian(ylim =c(0, 75), expand = FALSE) +
labs(x = " ",y = "Percent %" ) +
theme_bw() +
facet_wrap(~growth, scales = "free")
q5_p7
#res <- prop.test(x = c(51, 77), n = c(392, 405))
#res
Q10s <- c('Q10_a', 'Q10_b', 'Q10_c', 'Q10_d', 'Q10_e', 'Q10_f', 'Q10_g', 'Q10_h', 'Q10_i', 'Q10_j', 'Q10_k')
namess <- c("Accounting/Finance", "Call Center", "Distribution", "Engineering/R&D", "Headquarters", "Management",
"Manufacuring", "Services", "Warehousing", "IT/Technology", "Other")
edc2 <- edc %>% select(Q4, starts_with("Q10")) %>% filter(is.na(Q4)==F)
edc2$Q4 <- gsub("Yes", 1, edc2$Q4)
edc2$Q4 <- gsub("No", 0, edc2$Q4)
edc2$Q4 <- as.numeric(edc2$Q4)
overallavg <- mean(edc2$Q4)*100
Q10_names <- as.data.frame(namess)
Q10_names <- Q10_names %>% mutate('Avg_Q1'=0)
i=1
while(i <= length(Q10s)){
current <- Q10s[i]
edc3 <- edc2 %>% select(Q4, current[1])
TFvec <- (edc3[2] != 0)
edc3 <- edc3[TFvec,]
avg = mean(edc3$Q4)*100
Q10_names[i,2] <- avg
i = i+1
}
colnames(Q10_names) <- c("Business_Category","Export_percentage")
exports <- round(Q10_names$Export_percentage,1)
avgs <- ggplot(Q10_names, aes(x=Business_Category, y=Export_percentage)) +
geom_bar(color='black',fill='violetred4',stat='identity') +
#coord_cartesian(ylim =c(5, 7), expand = FALSE) +
labs(x = " ",y = "Percentage of Exporting Businesses" ) +
geom_hline(aes(yintercept=overallavg), color = "black") +
geom_text(aes(label=exports), position=position_dodge(width=0.9), vjust=-0.25) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1))
avgs
Q10s <- c('Q10_a', 'Q10_b', 'Q10_c', 'Q10_d', 'Q10_e', 'Q10_f', 'Q10_g', 'Q10_h', 'Q10_i', 'Q10_j', 'Q10_k')
namess <- c("Accounting/Finance", "Call Center", "Distribution", "Engineering/R&D", "Headquarters", "Management",
"Manufacuring", "Services", "Warehousing", "IT/Technology", "Other")
edc2 <- edc %>% select(Q4, starts_with("Q10")) %>% filter(is.na(Q4)==F)
edc2$Q4 <- gsub("Yes", 1, edc2$Q4)
edc2$Q4 <- gsub("No", 0, edc2$Q4)
edc2$Q4 <- as.numeric(edc2$Q4)
overallavg <- mean(edc2$Q4)*100
Q10_names <- as.data.frame(namess)
Q10_names <- Q10_names %>% mutate('Avg_Q1'=0)
i=1
while(i <= length(Q10s)){
current <- Q10s[i]
edc3 <- edc2 %>% select(Q4, current[1])
TFvec <- (edc3[2] != 0)
edc3 <- edc3[TFvec,]
avg = mean(edc3$Q4)*100
Q10_names[i,2] <- avg
i = i+1
}
colnames(Q10_names) <- c("Business_Category","Export_percentage")
exports <- round(Q10_names$Export_percentage,1)
avgs <- ggplot(Q10_names, aes(x=Business_Category, y=Export_percentage)) +
geom_bar(color='black',fill='magenta4',stat='identity') +
#coord_cartesian(ylim =c(5, 7), expand = FALSE) +
labs(x = " ",y = "Percentage of Exporting Businesses" ) +
geom_hline(aes(yintercept=overallavg), color = "black") +
geom_text(aes(label=exports), position=position_dodge(width=0.9), vjust=-0.25) +
theme_bw() +
theme(axis.text.x=element_text(angle=30, hjust=1))
avgs
Q10s <- c('Q10_a', 'Q10_b', 'Q10_c', 'Q10_d', 'Q10_e', 'Q10_f', 'Q10_g', 'Q10_h', 'Q10_i', 'Q10_j', 'Q10_k')
namess <- c("Accounting/Finance", "Call Center", "Distribution", "Engineering/R&D", "Headquarters", "Management",
"Manufacuring", "Services", "Warehousing", "IT/Technology", "Other")
edc2 <- edc %>% select(Q4, starts_with("Q10")) %>% filter(is.na(Q4)==F)
edc2$Q4 <- gsub("Yes", 1, edc2$Q4)
edc2$Q4 <- gsub("No", 0, edc2$Q4)
edc2$Q4 <- as.numeric(edc2$Q4)
overallavg <- mean(edc2$Q4)*100
Q10_names <- as.data.frame(namess)
Q10_names <- Q10_names %>% mutate('Avg_Q1'=0)
i=1
while(i <= length(Q10s)){
current <- Q10s[i]
edc3 <- edc2 %>% select(Q4, current[1])
TFvec <- (edc3[2] != 0)
edc3 <- edc3[TFvec,]
avg = mean(edc3$Q4)*100
Q10_names[i,2] <- avg
i = i+1
}
colnames(Q10_names) <- c("Business_Category","Export_percentage")
exports <- round(Q10_names$Export_percentage,1)
avgs <- ggplot(Q10_names, aes(x=Business_Category, y=Export_percentage)) +
geom_bar(color='black',fill='magenta4',stat='identity') +
#coord_cartesian(ylim =c(5, 7), expand = FALSE) +
labs(x = " ",y = "Percentage of Exporting Businesses" ) +
geom_hline(aes(yintercept=overallavg), color = "black") +
geom_text(aes(label=exports), position=position_dodge(width=0.9), vjust=-0.25) +
theme_bw() +
theme(axis.text.x=element_text(angle=-35, hjust=1))
avgs
edc$Q1 <- as.numeric(gsub(0, 1, edc$Q1))
#summary(edc$Q1)
p1 <- ggplot(edc %>% filter(Q1 < 100), aes(Q1)) +
geom_histogram(color = "black", fill = "lightskyblue", bins = 50) +
scale_y_continuous(limits = c(0,1200), expand = c(0,0)) +
#scale_x_continuous(limits = c(1,100), breaks=seq(1,100, by=1))+
geom_vline(aes(xintercept=6.6), color = "red") +
labs(x = "Employees", y="Count  Businesses") +
#labs(title = "How Many Employees Do You Have At Your Sarasota Location?") +
theme_bw()
p1
View(Q1_plot2)
View(Q1_plot2)
